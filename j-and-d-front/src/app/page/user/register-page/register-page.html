<h1>S'inscrire</h1>

@if (subscriptionError) {
<div class="alert alert-danger">Une erreur est survenue lors de l'inscription</div>
}

<form (ngSubmit)="connecter()" [formGroup]="userForm">
  <div class="mb-3 row">
    <label for="login" class="col-sm-2 col-form-label">Login</label>
    <div class="col-sm-10">
      <input
        type="text"
        class="form-control"
        id="login"
        formControlName="login"
        [class.is-invalid]="loginCtrl.invalid && (loginCtrl.dirty || loginCtrl.touched)"
      />

      @if (loginCtrl.hasError('required')) {
      <div class="invalid-feedback">Le login est obligatoire</div>
      }
    </div>
  </div>

  <div class="mb-3 row">
    <label for="password" class="col-sm-2 col-form-label">Mot de passe</label>
    <div class="col-sm-10">
      <input
        type="password"
        class="form-control"
        id="password"
        formControlName="password"
        [class.is-invalid]="passwordCtrl.invalid && (passwordCtrl.dirty || passwordCtrl.touched)"
      />

      @if (passwordCtrl.hasError('required')) {
      <div class="invalid-feedback">Le mot de passe est obligatoire</div>
      } @else if (passwordCtrl.hasError('minlength')) {
      <div class="invalid-feedback">Le mot de passe doit faire 6 caract√®res minimum</div>
      }
    </div>
  </div>

  <div class="mb-3 row">
    <label for="passwordConfirm" class="col-sm-2 col-form-label"
      >Confirmation du mot de passe</label
    >
    <div class="col-sm-10">
      <input
        type="password"
        class="form-control"
        id="passwordConfirm"
        formControlName="passwordConfirm"
        [class.is-invalid]="
          passwordConfirmCtrl.invalid && (passwordConfirmCtrl.dirty || passwordConfirmCtrl.touched)
        "
      />

      @if (passwordConfirmCtrl.hasError('required')) {
      <div class="invalid-feedback">La confirmation du mot de passe est obligatoire</div>
      } @else if (passwordConfirmCtrl.hasError('passwordMismatch')) {
      <div class="invalid-feedback">Les mots de passe ne correspondent pas</div>
      }
    </div>
  </div>

  <label class="checkbox-gm">
    <input type="checkbox" formControlName="gm" />
    Je suis Game Master
  </label>

  <div class="btn-group">
    <input type="submit" class="btn btn-success" [disabled]="userForm.invalid" value="S'inscrire" />
    <a type="button" class="btn btn-danger" routerLink="/login">Annuler</a>
  </div>
</form>
